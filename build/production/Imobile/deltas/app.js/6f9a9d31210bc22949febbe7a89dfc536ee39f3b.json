["function _2d9955aa50ea776e3fc1165c55e6fa18bfc52877",50,588261,"core.data.Store",628272,33,"autoLoad:false,listeners:{beforeload:function(b,a,c){b.getProxy().setExtraParams({Token:localStorage.getItem(\"Token\"),CodigoUsuario:",609311,37,",CodigoSociedad:",609366,38,",CodigoDispositivo:",609425,41,"})}}",588287,7706,"NombreAlmacen\",label:\"Almacen\",disabled:false,itemId:\"almacenProduc",595839,32,"Disponible\",label:\"Disponible",592541,34,596109,282," width: 180",596388,461,"display: table; text-align: left; font-size: 12px; z-index: 0;\"><div style=\"display: table-row;\"><div id=\"cliente_id\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">Transacci\ufffff\ufffffn: Orden de Venta</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">Fecha: 04/06/2014</div></div><div style=\"display: table-row;\"><div id=\"codigo_id\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">C\ufffff\ufffffdigo de Dispositivo: '+",609425,41,"+'</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">C\ufffff\ufffffdigo de Usuario: '+",609311,37,"+'</div></div><div style=\"display: table-row;\"><div id=\"codigo_dispositivo\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">Nombre de Dispositivo: '+localStorage.getItem(\"NombreDispositivo\")+'</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">Nombre de Usuario: '+localStorage.getItem(\"NombreUsuario\")+\"</div></div></div>\"",605342,95,597017,84,"vbox\",xtype:\"container\",docked:\"bottom\",items",606351,48,"Descuento\",flex:1.2,height:50,itemId:\"descuento\",style:{background:\"#696969\",color:\"white",606472,119,"Subtotal\",flex:1,itemId:\"subtotal\",style:{background:\"#696969\",color:\"white",606472,65,"}",597226,38,",itemId:\"tax\",style:{background:\"#696969\",color:\"white",606472,65,"}},{xtype:\"container\",html:\"Total\",flex:1,itemId:\"total\",style:{background:\"#A9A9A9\",color:\"black",606472,65,"}}]",602207,37,597342,146,"fit\"",597506,58,"7",597565,2357,"CondicionPago",599931,108,"NombreListaPrecio",598152,53,"CodigoV",600105,109,"Codigo",600220,1195,">{cantidad}",601427,152,601580,5846,"F",607427,34,"TipoTransaccion} <br> Cliente: {CodigoCliente} - {NombreC",607490,252,"ventas.Almacen",598336,32,"requires:[],xtype:\"almacen",604148,79,"Almacen}</b> {NombreAlmacen",604252,117,604385,56,607742,398,"almacenes:undefined",608139,342,",ordenContainer:\"ordencontainer\",partidaContainer:\"partidacontainer",608480,518,"console.log(d);",608998,232,"NombreUsuario\",d.Usuario.Nombre",609206,60,"localStorage.setItem(\"FolioInterno\",d.ConfiguracionDispositivo.FolioOrden);localStorage.setItem(\"NombreDispositivo\",d.ConfiguracionDispositivo.Nombre",609264,33,"almacenes=d.ConfiguracionDispositivo.Almacenes",609554,386,"c",620576,79,"var b=Ext.getStore(\"Ordenes\");if(b.getData().items.length<=1){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}",620380,32,"||",620658,62,620506,34,";",620720,54,610205,1193,"lienteSeleccionado:undefined,CodigoAlmacen:undefined,codigoImpuesto:undefined,tasaImpuesto",611394,426,"agregarproductosform #almacenProducto\":{focus:\"onListAlmacen",611816,452,612321,189,"editarPartida",612527,455,",almacenlist:{itemtap:\"onSeleccionarAlmace",612979,358,613429,47,"Ext.getStore(\"Clientes\").load(",613474,455,"digoDireccion",614011,32,"odigoDireccion;d.codigoImpuesto=b.data.CodigoImpuesto;d.tasaImpuesto=b.data.Tasa",614117,100,"Codigo",614223,98,"Codigo",614327,455,"j){if(j==\"yes\"){var h",614803,59,"h);d.actualizarTotales();var g=Ext.getStore(\"Ordenes\");if(g.getData().items.length<=2){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}}})},cambiaItem:function(f,j,b){var g=this,h=g.getMain().getActiveItem(),d=h",620448,45,",e=g.getOpcionCliente().clienteSeleccionado;if(j.xtype==\"clientecontainer\"){d.setText(\"Back\").show();d.setUi(\"back\");var c=j.down(\"clienteform\"",616032,32,"c.setValues(e)}if(j.xtype==\"editarpedidoform\"){j.setValues(e);d.setText(\"Back\").show();d.setUi(\"back\")}if(j.xtype==\"partidacontainer\"){d.setText(\"Agregar\").show();d",615812,151,"Moneda",621278,32,614397,385,"j){if(j==\"yes\"){var h",614803,59,"h);d.actualizarTotales();var g=Ext.getStore(\"Ordenes\");if(g.getData().items.length<=2){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}}})},cambiaItem:function(f,j,b){var g=this,h=g.getMain().getActiveItem(),d=h",620448,45,",e=g.getOpcionCliente().clienteSeleccionado;if(j.xtype==\"clientecontainer\"){d.setText(\"Back\").show();d.setUi(\"back\");var c=j.down(\"clienteform\"",616032,32,"c.setValues(e)}if(j.xtype==\"editarpedidoform\"){j.setValues(e);d.setText(\"Back\").show();d.setUi(\"back\")}if(j.xtype==\"partidacontainer\"){d.setText(\"Agregar\").show();d",615812,481,616319,356,616706,604,617364,87,"}b.pop()}l.actualizarTotales()",617566,713,"e,f,d,h){var j=this,k=j.getMenu(),b=d.get(\"NombreSocio\");j.idCliente=d.get(\"CodigoSocio\");j.titulo=j.idCliente+\" \"+b;switch(g.opcion){case\"venta\":k",618426,39,"j.titulo,clienteSeleccionado:d.data});var c=j.getOpcionCliente().clienteSeleccionado",616033,33,"setData(c.Direcciones);a.filter(\"TipoDireccion\",\"S\");if(a.getCount()>0){j.direccionFiscal=a.getAt(0).data.CodigoDireccion;j.codigoImpuesto=a.getAt(0).data.CodigoImpuesto;j.tasaImpuesto=a.getAt(0).data.Tasa;a.clearFilter();a.filter(\"TipoDireccion\",\"B\");j.direccionEntrega=a.getAt(0).data.CodigoDireccion}else{j.mandaMensaje(\"Sin direcci\ufffff\ufffffn fiscal\",\"Este cliente no cuenta con direcci\ufffff\ufffffn fiscal, solicite una al SAP.\");k.pop()}break;case\"cobranza\":k",618498,34,"j",618533,69,"k,h,j,f){var n=this,o=n.getMain().getActiveItem(),c=f.data,d,e=n.almacenes,g,m,b,l,d;Ext.Array.forEach(e,function(r,p){var q=r.Predeterminado;n.CodigoAlmacen=r.CodigoAlmacen;if(q){c.NombreAlmacen=r.NombreAlmacen}});o",618664,38,"var a=o.getActiveItem();a.setValues(c);a.setValues({Precio:c.ListaPrecios[0].Precio,moneda:c.ListaPrecios[0].CodigoMoneda,cantidad:1});d=a",608755,49,628700,43,"ObtenerPrecioEspecialiMobile\",params:{CodigoUsuario:",609311,37,",CodigoSociedad:",609366,38,",CodigoDispositivo:",609425,41,",Token:localStorage.getItem(\"Token\"),ItemCode:c.CodigoArticulo,CardCode:n.idCliente,ListaPrecio:c.ListaPrecios[0].CodigoLista,Cantidad:d.cantida",608952,43,"p){var q=p.Procesada,r=p.Data[0]*100/d.Precio;if(q){a.setValues({descuento:r});m=d.Precio-r,b=m*n.tasaImpuesto/100,l=m*d.cantidad+b,a.setValues({descuento:r,totalDeImpuesto:b,importe:l,precioConDescuento:m});if(c.cantidad>0){a",618952,46,"o",620448,53,609554,40,"p.Descripcion,Ext.emptyFn)}}})},editarPartida:function(f,d,e,c){var g=this,h=g.getMain().getActiveItem(),a,j=c.data.CodigoArticulo,l=Ext.getStore(\"Ordenes\"),b=l.find(\"CodigoArticulo\",j),k=l.getAt(b).data;console.log(k);h",618664,39,"=h.getActiveItem();a",618952,46,"h",620448,52,";a.setValues(k)},actualizaCantidad:function(h,g",618607,45,"f=a.getActiveItem().getValues(),c=f.precioConDescuento*g,e=g*f.totalDeImpuesto",618846,38,"c+e,totalDeImpuesto:",619219,418,"g.actualizarTotales();g.getPartidaContainer().down(\"list\").emptyTextCmp.show(",619635,60,",a={CardCode:\"C00001\"",619837,416,"c){var e=this,a=e.getMain().getActiveItem(),d=c.up(\"navigationorden\"),f=d",620622,32,",b=Ext.getStore(\"Productos\");if(f.isXType(\"partidacontainer\")){var g={CardCode:e.idCliente,page:1};b.setParams(g);",620414,33,"b.load();",620720,47,"hide()}else{d",620507,486,"g,c){var b=Ext.getStore(d);params",621021,67,"g",621089,35,"params",621125,43,"d=this,c=0,a=Ext.getStore(\"Ordenes\"),f=a.getData().items;if(f.length>0){var b=parseInt(localStorage.getItem(\"FolioInterno\"))+1;var e={CodigoUsuario:",609311,37,",CodigoSociedad:",609366,38,",CodigoDispositivo:",609425,41,",Token:localStorage.getItem(\"Token\"),\"Orden.FolioInterno\":b,\"Orden.CodigoCliente\":d.idCliente,\"Orden.FechaCreacion\":\"2014-06-04\",\"Orden.FechaEntrega\":\"2014-06-04\",\"Orden.CodigoMoneda\":\"$\"};localStorage.setItem(\"FolioInterno\",b);Ext.Array.forEach(f,function(j,g,h){console.log(j);c+=(j.get(\"precioConDescuento\")*j.get(\"cantidad\"))+j.get(\"totalDeImpuesto\");e[\"Orden.Partidas[\"+g+\"].CodigoArticulo\"]=j.get(\"CodigoArticulo\");e[\"Orden.Partidas[\"+g+\"].Cantidad\"]=j.get(\"cantidad\");e[\"Orden.Partidas[\"+g+\"].Precio\"]=j.get(\"Precio\");e[\"Orden.Partidas[\"+g+\"].CodigoAlmacen\"]=d.CodigoAlmacen;e[\"Orden.Partidas[\"+g+\"].Linea\"]=g;e[\"Orden.Partidas[\"+g+\"].Moneda\"]=j.get(\"moneda\");e[\"Orden.Partidas[\"+g+\"].Importe\"]=j.get(\"precioConDescuento\")*j.get(\"cantidad\")});e[\"Orden.TotalDocumento\"]=parseFloat(c).toFixed(2);console.log(e",608766,38,628700,33,"OrdenVenta/AgregarOrdenMobile\",params:e",608954,41,"g){d.getMain().setActiveItem(1);if(g.Procesada){Ext.Msg.alert(\"Orden Procesada\",\"Se agrego la orden correctamente con folio: \"+g.CodigoUnicoDocumento);a.clearData();d",621205,32,"}else{Ext.Msg.alert(\"Orden No Procesada\",\"No se proceso la orden correctamente\")}}})}else{d.getMain().setActiveItem(1);Ext.Msg.alert(\"Productos\",\"Selecciona al menos un Producto\")}",621252,596,621870,529,608768,36,628700,68,"\",params:{CodigoUsuario:",609311,37,",CodigoSociedad:",609366,38,",CodigoDispositivo:",609425,41,",Token:localStorage.getItem(\"Token\"),Criterio:2",608953,42,"c){b.getMain().setActiveItem(2);b",619505,55,"b.titulo);b",619571,67,".actualizarTotales();b.getPartidaContainer().down(\"list\").emptyTextCmp.show()}})},actualizarTotales:function(){var e=this,b=Ext.getStore(\"Ordenes\").getData().items,f=0,a=0,d=0,c=0;Ext.Array.forEach(b,function(h,g){f+=h.get(\"Precio\")*h.get(\"cantidad\");a+=h.get(\"descuento\")*h.get(\"cantidad\");c+=h.get(\"totalDeImpuesto\");d+=h.get(\"importe\")});e.getOrdenContainer().down(\"#descuento",622128,36,"a});e.getOrdenContainer().down(\"#subtotal",622128,36,"parseFloat(f).toFixed(2)});e.getOrdenContainer().down(\"#tax",622128,36,"parseFloat(c).toFixed(2)});e.getOrdenContainer().down(\"#total",622128,36,"parseFloat(d).toFixed(2)})},onListAlmacen:function(c,g",618607,45,"f=a.down(\"agregarproductosform\").getValues();a.push({xtype:\"almacenlist\",codigoArticulo:f.CodigoArticulo});a.down(\"almacenlist\").setData(d.almacenes)},onSeleccionarAlmacen:function(f,c,j,b,h,d){var g=this,a=g.getMain().getActiveItem();g.CodigoAlmacen=b.get(\"CodigoAlmacen\"",608766,38,"192.168.15.9:88/iMobile/COK1_CL_Consultas/ObtenerDisponibleiMobile\",params:{CodigoUsuario:",609311,37,608885,46,"ItemCode:f.codigoArticulo,Token:localStorage.getItem(\"Token\"),Almacen:b.get(\"CodigoAlmacen\")",608953,42,"e){var k={Disponible:e.Data[0],NombreAlmacen:b.get(\"NombreAlmacen\")};a.down(\"agregarproductosform\").setValues(k);a.pop()}",622431,1217,",{name:\"CodigoVendedor\",type:\"string\"},{name:\"CondicionPago\",type:\"string\"},{name:\"NombreListaPre",625769,33,"Moneda",588431,41,"store.Clientes\",{extend:Imobile.core",624542,41,"Cliente\"",627247,53,610441,32,627337,77,",extraParams:{format:\"json",627412,33,623956,406,"NombreAlmacen\",type:\"string\"},{name:\"Disponible",624403,55,"},{name:\"ListaPrecios\",type:\"array\"},{name:\"SujetoImpuesto\",type:\"boolean\"",624459,80,"Imobile.core",624542,51,627248,52,"Articulo/ObtenerListaArticulo",627328,86,",extraParams:{format:\"json\"}}}",625656,452,"NombreAlmacen\",type:\"string\"},{name:\"Disponible",626149,114,626276,454,",{name:\"CodigoImpuesto\",type:\"string\",},{name:\"Tasa\",type:\"string\"},{name:\"Codig",626704,478,"Imobile.core",624542,41,627226,188,",extraParams:{type:\"json",627412,934,628347,89,"Fol",625770,32,"Cliente\",type:\"string\"},{name:\"NombreCliente\",type:\"string\"},{name:\"TipoTransaccion",628543,67,"Imobile.core",624542,41,"Transaccion\"",627247,54,"onsultas/RegresarOrdenVentaAbierta",623840,85,",extraParams:{format:\"json",628845,949]