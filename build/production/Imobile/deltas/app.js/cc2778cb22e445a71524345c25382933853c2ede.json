["function _2d9955aa50ea776e3fc1165c55e6fa18bfc52877",50,289262,"abel",437391,32,"abel",309664,37,"label\"",289291,298916,"core.data.Store",621952,33,"autoLoad:false,listeners:{beforeload:function(b,a,c){b.getProxy().setExtraParams({Token:localStorage.getItem(\"Token\"),CodigoUsuario:",608140,37,",CodigoSociedad:",608195,38,",CodigoDispositivo:",608254,41,"})",621405,32,"Menu",624000,48,588265,7222,"itemId:\"cantidad\"},{xtype:\"numberfield\",name:\"P",595543,355,"NombreAlmacen\",label:\"Almacen\",disabled:false,itemId:\"almacenProduc",595744,32,"Disponible\",label:\"Disponible",598189,41,"Orden",604302,39,596065,231," width: 180",596293,259,"Preci",596367,33,596590,164,"display: table; text-align: left; font-size: 12px; z-index: 0;\"><div style=\"display: table-row;\"><div id=\"cliente_id\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">Transacci\ufffff\ufffffn: Orden de Venta</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">Fecha: 04/06/2014</div></div><div style=\"display: table-row;\"><div id=\"codigo_id\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">C\ufffff\ufffffdigo de Dispositivo: '+",608254,41,"+'</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">C\ufffff\ufffffdigo de Usuario: '+",608140,37,"+'</div></div><div style=\"display: table-row;\"><div id=\"codigo_dispositivo\" style=\"display: table-cell;  padding-left: 10px; padding-right: 10px;\">Nombre de Dispositivo: '+localStorage.getItem(\"NombreDispositivo\")+'</div><div style=\"display: table-cell;  padding-left: 15px; padding-right: 5px;\">Nombre de Usuario: '+localStorage.getItem(\"NombreUsuario\")+\"</div></div></div>\"}",601552,67,596895,111,"vbox\",xtype:\"container\",docked:\"bottom\",items",606195,48,"Descuento\",flex:1.2,height:50,itemId:\"descuento\",style:{background:\"#696969\",color:\"white\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\",\"vertical-align\":\"middle\"}",597088,43,",itemId:\"subtotal\",style:{background:\"#696969\",color:\"white\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\"}",597131,38,",itemId:\"tax\",style:{background:\"#696969\",color:\"white\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\"}},{xtype:\"container\",html:\"Total\",flex:1,itemId:\"total\",style:{background:\"#A9A9A9\",color:\"black\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\"}}]}",596893,36,597247,146,"fit",606564,43,"ordenlist\",flex:7",597470,700,"S",598171,1587,"LimiteCredito",599764,56,"CondicionPago",599829,61,"S",599891,46,"NombreListaPrecio",598057,53,"CodigoV",599998,109,"Codigo",600113,1148,"tpl if=\"cantidad &gt; 0\">','<div class= \"ovalo\">{cantidad}</div>',\"</tpl>\"",601287,136,601424,4829,"flex:1,itemId:\"aCobrar\",style:{background:\"black\",color:\"yellow\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\",\"vertical-align\":\"middle\"}",606281,41,",itemId:\"pagado\",style:{background:\"black\",color:\"green\",\"margin-right\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\"}",606322,44,",itemId:\"pendiente\",style:{background:\"black\",color:\"red\",\"margin-righ\":\"1px\",\"text-align\":\"center\",\"font-weight\":\"bold\"}",593023,33,606399,268,"xtype:\"button\",text:\"Terminar\",ui:\"confirm",605549,42,"ventas.Transac",591039,43,"transaccion",589619,45,"useSimpleItems:true,itemTpl:\"Folio: {Folio} <br> Tipo de transacci\ufffff\ufffffn: {TipoTransaccion} <br> Cliente: {CodigoCliente} - {NombreCliente}\",store:\"Transacciones",602702,39,590074,77,"transaccion",590158,96,"ventas.Almacen",603934,51,"almacen",603992,79,"Almacen}</b> {NombreAlmacen",604096,117,604229,56,606728,320,"direccionEntrega:undefined,direccionFiscal:undefined,dirIP:\"25.15.241.121:88\",almacenes",607037,296,",totales:\"totalescontainer\",listaFacturas:\"facturaslist\",ordenContainer:\"ordencontainer\",partidaContainer:\"partidacontainer",607332,168,"pop:\"onPopNavigationOrden\",",607500,129,"\"+b.dirIP+\"",607644,183,"console.log(d);",607827,232,"NombreUsuario\",d.Usuario.Nombre",608035,60,"localStorage.setItem(\"FolioInterno\",d.ConfiguracionDispositivo.FolioOrden);localStorage.setItem(\"NombreDispositivo\",d.ConfiguracionDispositivo.Nombre",608093,33,"almacenes=d.ConfiguracionDispositivo.Almacenes",608383,386,"c",618213,43,"e=c",608816,33,"var b=Ext.getStore(\"Ordenes\");if(b.getData().items.length<=1){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}if(e.isXType(\"partidacontainer\")||e.isXType(\"clientecontainer\")||e.isXType(\"editarpedidoform\")){c",608989,296,"\"+b.dirIP+\"",620439,49,609349,894,"aPagar:0,pagado:0,pendiente:0,clienteSeleccionado:undefined,CodigoAlmacen:undefined,codigoImpuesto:undefined,tasaImpuesto:0",610242,362,"agregarproductosform #cantidad\":{change:\"actualizaCantidad\"},\"agregarproductosform #almacenProducto\":{focus:\"onListAlmacen",610600,452,611105,189,"editarPartida",611311,59,"clientecontainer #guardar\":{tap:\"guardaDatosDeCliente",611366,290,",transaccionlist:{itemtap:\"onSeleccionarTransaccion\"},almacenlist:{itemtap:\"onSeleccionarAlmacen",611654,357,612103,47,"Ext.getStore(\"Clientes\").load(",612148,372,618215,40,";if(d.entrega){d.direccionEntrega=b.data.CodigoDireccion}else{d.direccionFiscal=b.data.CodigoDireccion;d.codigoImpuesto=b.data.CodigoImpuesto;d.tasaImpuesto=b.data.Tasa}a.pop()},seleccionaMoned",618825,39,"ain().getActiveItem();moneda=b.data.CodigoMoneda,tabOpciones=d.getOpcionesOrden(),form=tabOpciones.down(\"editarpedidoform\");form.setValues({CodigoMoneda:moneda});a.pop(",612866,433,"j){if(j==\"yes\"){var h",613320,59,"h);d.actualizarTotales();var g=Ext.getStore(\"Ordenes\");if(g.getData().items.length<=2){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}}})},cambiaItem:function(f,j,b){var g=this,h=g.getMain().getActiveItem(),d=h",609024,45,",e=g.getOpcionCliente().clienteSeleccionado;if(j.xtype==\"clientecontainer\"){d.setText(\"Back\").show();d.setUi(\"back\");var c=j.down(\"clienteform\"",614225,32,"c.setValues(e)}if(j.xtype==\"editarpedidoform\"){j.setValues(e);d.setText(\"Back\").show();d.setUi(\"back\")}if(j.xtype==\"partidacontainer\"){d.setText(\"Agregar\").show();d.setUi(\"normal\"",614020,136,612876,423,"j){if(j==\"yes\"){var h",613320,59,"h);d.actualizarTotales();var g=Ext.getStore(\"Ordenes\");if(g.getData().items.length<=2){d.getPartidaContainer().down(\"list\").emptyTextCmp.show()}else{d.getPartidaContainer().down(\"list\").emptyTextCmp.hide()}}})},cambiaItem:function(f,j,b){var g=this,h=g.getMain().getActiveItem(),d=h",609024,45,",e=g.getOpcionCliente().clienteSeleccionado;if(j.xtype==\"clientecontainer\"){d.setText(\"Back\").show();d.setUi(\"back\");var c=j.down(\"clienteform\"",614225,32,"c.setValues(e)}if(j.xtype==\"editarpedidoform\"){j.setValues(e);d.setText(\"Back\").show();d.setUi(\"back\")}if(j.xtype==\"partidacontainer\"){d.setText(\"Agregar\").show();d.setUi(\"normal\"",614020,466,614512,89,614634,88,"){var b",614734,34,"b",614635,47,614836,46,"e,c,d){e.set(\"color\",b",614904,108,615099,34,"o,e,k,p,l=this,p=Ext.getStore(\"Ordenes\"),g=Ext.getStore(\"Productos\"),b=l.getMain().getActiveItem(),a=c.up(\"agregarproductosform\"),o=a.getValues(),e=o.NombreArticulo,k=o.cantidad,j=o.importe",615286,32,"k)){l",615323,130,"n=o.CodigoArticulo,d=p.find(\"CodigoArticulo\",n),f=g.find(\"CodigoArticulo\",n),h=g.getAt(f);h.set(\"cantidad\",k);if(d==-1){p.add(o)}else{var m=p.getAt(d);m.set(\"cantidad\",k);m.set(\"NombreArticulo\",e);m.set(\"importe\",j)}b.pop()}l.actualizarTotales()",615650,613,"DesplegarEnPanel\",c)",616301,80,"e,f,d,h){var j=this,k=j.getMenu(),b=d.get(\"NombreSocio\");j.idCliente=d.get(\"CodigoSocio\");j.titulo=j.idCliente+\" \"+b;switch(g.opcion){case\"venta\":k",616528,39,"j.titulo,clienteSeleccionado:d.data});var c=j.getOpcionCliente().clienteSeleccionado",614226,33,"setData(c.Direcciones);a.filter(\"TipoDireccion\",\"S\");if(a.getCount()>0){j.direccionFiscal=a.getAt(0).data.CodigoDireccion;j.codigoImpuesto=a.getAt(0).data.CodigoImpuesto;j.tasaImpuesto=a.getAt(0).data.Tasa;a.clearFilter();a.filter(\"TipoDireccion\",\"B\");j.direccionEntrega=a.getAt(0).data.CodigoDireccion}else{j.mandaMensaje(\"Sin direcci\ufffff\ufffffn fiscal\",\"Este cliente no cuenta con direcci\ufffff\ufffffn fiscal, solicite una al SAP.\");k.pop()}break;case\"cobranza\":k",616600,34,"j",616635,69,"k,h,j,f){var n=this,o=n.getMain().getActiveItem(),c=f.data,d,e=n.almacenes,g,m,b,l,d;Ext.Array.forEach(e,function(r,p){var q=r.Predeterminado;n.CodigoAlmacen=r.CodigoAlmacen;if(q){c.NombreAlmacen=r.NombreAlmacen}});o",616778,42,"a=o.getActiveItem();a.setValues(c);a.setValues({Precio:c.ListaPrecios[0].Precio,moneda:c.ListaPrecios[0].CodigoMoneda,cantidad:1});d=a",607580,49,"25.15.241.121:88/iMobile/COK1_CL_Consultas/ObtenerPrecioEspecialiMobile\",params:{CodigoUsuario:",608140,37,",CodigoSociedad:",608195,38,",CodigoDispositivo:",608254,41,",Token:localStorage.getItem(\"Token\"),ItemCode:c.CodigoArticulo,CardCode:n.idCliente,ListaPrecio:c.ListaPrecios[0].CodigoLista,Cantidad:d.cantida",607781,43,"p){var q=p.Procesada,r=p.Data[0]*100/d.Precio;if(q){a.setValues({descuento:r});m=d.Precio-r,b=m*n.tasaImpuesto/100,l=m*d.cantidad+b,a.setValues({descuento:r,totalDeImpuesto:b,importe:l,precioConDescuento:m});if(c.cantidad>0){a",617231,46,"o",614432,53,608383,40,"p.Descripcion,Ext.emptyFn)}}})},editarPartida:function(f,d,e,c){var g=this,h=g.getMain().getActiveItem(),a,j=c.data.CodigoArticulo,l=Ext.getStore(\"Ordenes\"),b=l.find(\"CodigoArticulo\",j),k=l.getAt(b).data;console.log(k);h",616778,38,"a=h.getActiveItem();a",617231,46,"h",614432,52,";a.setValues(k)},actualizaCantidad:function(h,g,b",618213,45,"a.getActiveItem().getValues(),c=f.precioConDescuento*g,e=g*f.totalDeImpuesto;a.getActiveItem().setValues({importe:c+e,totalDeImpuesto:e})},guardaDatosDeCliente:function(a){var b=this;b.mandaMensaje(\"C\ufffff\ufffffdigos de direcci\ufffff\ufffffn\",\"Entrega: \"+b.direccionEntrega+\"\\nFiscal: \"+b.direccionFiscal)},onOpcionesCliente:function(l,c,d,b,f){var g=this,h=g.getMenu(),k=b.get(\"action\");switch(k",617422,176,"g.actualizarTotales();g.getPartidaContainer().down(\"list\").emptyTextCmp.show();break;case\"visualizar\":var j=Ext.getStore(\"Transacciones\"),a={CardCode:\"C00001\"};j.setParams(a);j.load();h.push({xtype:\"transaccionlist\"}",617596,358,"c){var e=this,a=e.getMain().getActiveItem(),d=c.up(\"navigationorden\"),f=d",608816,32,",b=Ext.getStore(\"Productos\");if(f.isXType(\"partidacontainer\")){var g={CardCode:e.idCliente,page:1};b.setParams(g",618088,35,"b.load(",613055,56,"else{d",608989,33,"}",618176,35,618213,43,"e=c",608816,33,"if(e.isXType(\"clientecontainer\")||e.isXType(\"editarpedidoform\")){",609023,54,"if(e.isXType(\"partidacontainer\")&&b.isXType(\"agregarproductosform\")){",609023,58,"Add",618541,58,"ponParametros:function(d,a,f,e,g,c){var b=Ext.getStore(d);params",618415,67,"g",618483,35,"params",618519,43,"d=this,c=0,a=Ext.getStore(\"Ordenes\"),f=a.getData().items;if(f.length>0){var b=parseInt(localStorage.getItem(\"FolioInterno\"))+1;var e={CodigoUsuario:",608140,37,",CodigoSociedad:",608195,38,",CodigoDispositivo:",608254,41,",Token:localStorage.getItem(\"Token\"),\"Orden.FolioInterno\":b,\"Orden.CodigoCliente\":d.idCliente,\"Orden.FechaCreacion\":\"2014-06-04\",\"Orden.FechaEntrega\":\"2014-06-04\",\"Orden.CodigoMoneda\":\"$\"};localStorage.setItem(\"FolioInterno\",b);Ext.Array.forEach(f,function(j,g,h){console.log(j);c+=(j.get(\"precioConDescuento\")*j.get(\"cantidad\"))+j.get(\"totalDeImpuesto\");e[\"Orden.Partidas[\"+g+\"].CodigoArticulo\"]=j.get(\"CodigoArticulo\");e[\"Orden.Partidas[\"+g+\"].Cantidad\"]=j.get(\"cantidad\");e[\"Orden.Partidas[\"+g+\"].Precio\"]=j.get(\"Precio\");e[\"Orden.Partidas[\"+g+\"].CodigoAlmacen\"]=d.CodigoAlmacen;e[\"Orden.Partidas[\"+g+\"].Linea\"]=g;e[\"Orden.Partidas[\"+g+\"].Moneda\"]=j.get(\"moneda\");e[\"Orden.Partidas[\"+g+\"].Importe\"]=j.get(\"precioConDescuento\")*j.get(\"cantidad\")});e[\"Orden.TotalDocumento\"]=parseFloat(c).toFixed(2);console.log(e",607591,38,"25.15.241.121:88/iMobile/COK1_CL_OrdenVenta/AgregarOrdenMobile\",params:e",607783,41,"g){d.getMain().setActiveItem(1);if(g.Procesada){Ext.Msg.alert(\"Orden Procesada\",\"Se agrego la orden correctamente con folio: \"+g.CodigoUnicoDocumento);a.clearData();d.getMain().getActiveItem().pop()}else{Ext.Msg.alert(\"Orden No Procesada\",\"No se proceso la orden correctamente\")}}})}else{d.getMain().setActiveItem(1);Ext.Msg.alert(\"Productos\",\"Selecciona al menos un Producto\")}",618597,142,"e=this,b=e.getMenu(),c,d=0,a=b.getActiveItem().down(\"facturaslist\").getSelection();for(c=0;c<a.length;c++){d+=a[c].data.saldo}e.aPagar=d;b",618761,38,"e",618800,140,";",618941,124,";d.pagado=0;h.each(function(l){d.pagado+=parseFloat(l.get(\"monto\"))});d.getTotales().down(\"#pagado\").setItems({xtype:\"container\",html:d.pagado});d.getTotales().down(\"#pendiente\").setItems({xtype:\"container\",html:d.aPagar-d.pagado})}else{}});d.getTotales().down(\"#aCobrar\").setItems({xtype:\"container\",html:d.aPagar});d.getTotales().down(\"#pagado\").setItems({xtype:\"container\",html:d.pagado});d.getTotales().down(\"#pendiente\").setItems({xtype:\"container\",html:d.aPagar-d.pagado})},onSeleccionarTransaccion",618624,37,607593,36,"25.15.241.121:88/iMobile/COK1_CL_Consultas/RegresarOrdenVentaiMobile\",params:{CodigoUsuario:",608140,37,",CodigoSociedad:",608195,38,",CodigoDispositivo:",608254,41,",Token:localStorage.getItem(\"Token\"),Criterio:2",607782,42,"c){b.getMain().setActiveItem(2);b",617466,55,"b.titulo);b",617532,67,".actualizarTotales();b.getPartidaContainer().down(\"list\").emptyTextCmp.show()}})},actualizarTotales:function(){var e=this,b=Ext.getStore(\"Ordenes\").getData().items,f=0,a=0,d=0,c=0;Ext.Array.forEach(b,function(h,g){f+=h.get(\"Precio\")*h.get(\"cantidad\");a+=h.get(\"descuento\")*h.get(\"cantidad\");c+=h.get(\"totalDeImpuesto\");d+=h.get(\"importe\")});e.getOrdenContainer().down(\"#descuento\").setItems({xtype:\"container\",html:a});e.getOrdenContainer().down(\"#subtotal\").setItems({xtype:\"container\",html:parseFloat(f).toFixed(2)});e.getOrdenContainer().down(\"#tax\").setItems({xtype:\"container\",html:parseFloat(c).toFixed(2)});e.getOrdenContainer().down(\"#total\").setItems({xtype:\"container\",html:parseFloat(d).toFixed(2)})},onListAlmacen:function(c,g,b",618213,45,"a.down(\"agregarproductosform\").getValues();a.push({xtype:\"almacenlist\",codigoArticulo:f.CodigoArticulo});a.down(\"almacenlist\").setData(d.almacenes)},onSeleccionarAlmacen:function(f,c,j,b,h,d){var g=this,a=g.getMain().getActiveItem();g.CodigoAlmacen=b.get(\"CodigoAlmacen\"",607591,70,"Consultas/ObtenerDisponibleiMobile\",params:{CodigoUsuario:",608140,37,607714,46,"ItemCode:f.codigoArticulo,Token:localStorage.getItem(\"Token\"),Almacen:b.get(\"CodigoAlmacen\")",607782,42,"e){var k={Disponible:e.Data[0],NombreAlmacen:b.get(\"NombreAlmacen\")};a.down(\"agregarproductosform\").setValues(k);a.pop()",619071,1163,"S",620235,54,",{name:\"CodigoVendedor\",type:\"string\"},{name:\"CondicionPago\",type:\"string\"},{name:\"NombreListaPrec",622301,32,622862,53,"Clientes\",{extend:Imobile.core",621965,41,"Cliente\",proxy:{url:\"http://25.15.241.121",613750,33,620469,96,",extraParams:{format:\"json",621404,33,"Producto",624000,71,621548,92,"float\",defaultValue:0},{name:\"P",620781,204,"NombreAlmacen\",type:\"string\"},{name:\"Disponible\",type:\"float\"},{name:\"DesplegarEnPanel\",type:\"boolean\"},{name:\"ListaPrecios\",type:\"array\"},{name:\"SujetoImpuesto\",type:\"boolean\"",621091,80,"Imobile.core",621965,41,"Producto\",proxy:{url:\"http://25.15.241.121",617037,36,621307,99,",extraParams:{format:\"json",621404,236,"float\"},{name:\"P",620781,204,"NombreAlmacen\",type:\"string\"},{name:\"Disponible",621899,114,622026,454,",{name:\"CodigoImpuesto\",type:\"string\",},{name:\"Tasa\",type:\"string\"},{name:\"Codig",622454,478,"Imobile.core",621965,41,"Moneda",621223,35,"25.15.241.121:88/iMobile/COK1_CL_Catalogos/ObtenerListaMoneda",620479,86,",extraParams:{type:\"json",621404,33,623280,91,"float",623377,225,"10000",623617,65,"20000",623697,65,"30000",623777,65,"40000",623857,65,"50000",623937,295,"}});Ext.define(\"Imobile.model.Transa",622060,53,"Fol",622301,32,"Cliente\",type:\"string\"},{name:\"NombreCliente\",type:\"string\"},{name:\"TipoTransaccion\",type:\"int",620287,33,"Transacciones\",{extend:Imobile.core",621965,41,"Transaccion\",proxy:{url:\"http://25.15.241.121:88/iMobile/COK1_CL_Consultas/RegresarOrdenVentaAbierta",620480,85,",extraParams:{format:\"json\"}}",624233,166,",\"Transaccion",624396,767]